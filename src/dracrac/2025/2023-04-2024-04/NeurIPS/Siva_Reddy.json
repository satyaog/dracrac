[{"paper_id": "bb8baec77317a6027379e8c6e362e8ba", "title": "The Impact of Positional Encoding on Length Generalization in Transformers", "abstract": "Length generalization, the ability to generalize from small training context sizes to larger ones, is a critical challenge in the development of Transformer-based language models. Positional encoding (PE) has been identified as a major factor influencing length generalization, but the exact impact of different PE schemes on extrapolation in downstream tasks remains unclear. In this paper, we conduct a systematic empirical study comparing the length generalization performance of decoder-only Transformers with five different position encoding approaches including Absolute Position Embedding (APE), T5's Relative PE, ALiBi, and Rotary, in addition to Transformers without positional encoding (NoPE). Our evaluation encompasses a battery of reasoning and mathematical tasks. Our findings reveal that the most commonly used positional encoding methods, such as ALiBi, Rotary, and APE, are not well suited for length generalization in downstream tasks. More importantly, NoPE outperforms other explicit positional encoding methods while requiring no additional computation. We theoretically demonstrate that NoPE can represent both absolute and relative PEs, but when trained with SGD, it mostly resembles T5's relative PE attention patterns. Finally, we find that scratchpad is not always helpful to solve length generalization and its format highly impacts the model's performance. Overall, our work suggests that explicit position embeddings are not essential for decoder-only Transformers to generalize well to longer sequences.", "authors": [{"author": {"author_id": "e1cf93c2eb9d7dc820562aca3a0ac231", "name": "Amirhossein Kazemnejad", "links": [{"type": "openreview", "link": "~Amirhossein_Kazemnejad1"}, {"type": "semantic_scholar", "link": "1754452702"}]}, "affiliations": [{"institution_id": "2d64978822ccf8676fd9f98e10c823c2", "name": "McGill University", "category": "unknown"}, {"institution_id": "78a83265183550c66a78ff9b5f9b960f", "name": "Mila", "category": "unknown"}]}, {"author": {"author_id": "ca561630987ea7da0a08ecd951f40c4f", "name": "Inkit Padhi", "links": [{"type": "semantic_scholar", "link": "8350409"}]}, "affiliations": [{"institution_id": "3321dddb684e326e274a1c40845168a8", "name": "IBM Research", "category": "unknown"}]}, {"author": {"author_id": "8d1c048fb897e9b7378026ec3a96a4c1", "name": "Karthikeyan Natesan", "links": []}, "affiliations": []}, {"author": {"author_id": "c362684092460fe82aaa2f56f033b84b", "name": "K. Ramamurthy", "links": [{"type": "semantic_scholar", "link": "1704263"}]}, "affiliations": [{"institution_id": "3321dddb684e326e274a1c40845168a8", "name": "IBM Research", "category": "unknown"}]}, {"author": {"author_id": "b6c8ff4746c393c86fea619378fe8d72", "name": "Payel Das", "links": [{"type": "openreview", "link": "~Payel_Das1"}, {"type": "semantic_scholar", "link": "1730372"}, {"type": "semantic_scholar", "link": "2283308757"}, {"type": "semantic_scholar", "link": "2305555460"}]}, "affiliations": [{"institution_id": "3321dddb684e326e274a1c40845168a8", "name": "IBM Research", "category": "unknown"}]}, {"author": {"author_id": "d76795e0f68451af897d827a76a9dceb", "name": "Siva Reddy", "links": [{"type": "bio", "link": "siva-reddy"}, {"type": "email.mila", "link": "siva.reddy@mila.quebec"}, {"type": "mag", "link": "2169793708"}, {"type": "mag", "link": "2924809679"}, {"type": "openreview", "link": "~Siva_Reddy1"}, {"type": "semantic_scholar", "link": "145732771"}, {"type": "semantic_scholar", "link": "2256152032"}, {"type": "semantic_scholar", "link": "2258337753"}, {"type": "semantic_scholar", "link": "2260275234"}, {"type": "semantic_scholar", "link": "2283521815"}, {"type": "semantic_scholar", "link": "2283521818"}, {"type": "semantic_scholar", "link": "2284034011"}, {"type": "semantic_scholar", "link": "2286656700"}, {"type": "semantic_scholar", "link": "2289239506"}, {"type": "semantic_scholar", "link": "2289876704"}, {"type": "semantic_scholar", "link": "2295857229"}, {"type": "semantic_scholar", "link": "2301150002"}, {"type": "semantic_scholar", "link": "2312109206"}, {"type": "semantic_scholar", "link": "2313693935"}, {"type": "semantic_scholar", "link": "2323901201"}, {"type": "wpid_en", "link": "36949"}, {"type": "wpid_fr", "link": "37332"}]}, "affiliations": [{"institution_id": "2d64978822ccf8676fd9f98e10c823c2", "name": "McGill University", "category": "unknown"}, {"institution_id": "78a83265183550c66a78ff9b5f9b960f", "name": "Mila", "category": "unknown"}]}], "releases": [{"venue": {"venue_id": "2231305ebc59ffab234d656101ea6714", "name": "NeurIPS.cc/2023/Conference", "type": "conference", "date": {"text": "2023-09-21", "timestamp": 1695268800, "precision": 3}, "links": [{"type": "openreview-venue", "link": "NeurIPS.cc/2023/Conference"}], "publisher": null, "series": "", "volume": "NeurIPS 2023"}, "peer_reviewed": true, "status": "poster", "pages": null}], "topics": [{"name": "Transformers"}, {"name": "Positional Encoding"}, {"name": "Computer Science"}, {"name": "Length Generalization"}], "links": [{"type": "html.official", "link": "https://proceedings.neurips.cc//paper_files/paper/2023/hash/4e85362c02172c0c6567ce593122d31c-Abstract-Conference.html"}, {"type": "pdf.official", "link": "https://proceedings.neurips.cc/paper_files/paper/2023/file/4e85362c02172c0c6567ce593122d31c-Paper-Conference.pdf"}, {"type": "doi.abstract", "link": "10.48550/arXiv.2305.19466", "url": "https://doi.org/10.48550/arXiv.2305.19466"}, {"type": "openreview.abstract", "link": "Drrl2gcjzl", "url": "https://openreview.net/forum?id=Drrl2gcjzl"}, {"type": "openreview.pdf", "link": "Drrl2gcjzl", "url": "https://openreview.net/pdf?id=Drrl2gcjzl"}, {"type": "arxiv.abstract", "link": "2305.19466", "url": "https://arxiv.org/abs/2305.19466"}, {"type": "arxiv.pdf", "link": "2305.19466", "url": "https://arxiv.org/pdf/2305.19466.pdf"}, {"type": "dblp.abstract", "link": "conf/nips/KazemnejadPRDR23", "url": "https://dblp.uni-trier.de/rec/conf/nips/KazemnejadPRDR23"}, {"type": "pdf", "link": "http://export.arxiv.org/pdf/2305.19466"}, {"type": "html", "link": "http://papers.nips.cc/paper_files/paper/2023/hash/4e85362c02172c0c6567ce593122d31c-Abstract-Conference.html"}, {"type": "semantic_scholar.abstract", "link": "6f6e2e0311589a9af045f6acd00b7dee6d19fce4", "url": "https://www.semanticscholar.org/paper/6f6e2e0311589a9af045f6acd00b7dee6d19fce4"}, {"type": "corpusid", "link": "258987259"}], "flags": [{"name": "validation", "value": 1}], "validated": true, "citation_count": 0, "excerpt": null}, {"paper_id": "9ab1139a5d503b8215018452aa8e6276", "title": "Are Diffusion Models Vision-And-Language Reasoners?", "abstract": "Text-conditioned image generation models have recently shown immense qualitative success using denoising diffusion processes. However, unlike discriminative vision-and-language models, it is a non-trivial task to subject these diffusion-based generative models to automatic fine-grained quantitative evaluation of high-level phenomena such as compositionality. Towards this goal, we perform two innovations. First, we transform diffusion-based models (in our case, Stable Diffusion) for any image-text matching (ITM) task using a novel method called DiffusionITM. Second, we introduce the Generative-Discriminative Evaluation Benchmark (GDBench) benchmark with 7 complex vision-and-language tasks, bias evaluation and detailed analysis. We find that Stable Diffusion + DiffusionITM is competitive on many tasks and outperforms CLIP on compositional tasks like like CLEVR and Winoground. We further boost its compositional performance with a transfer setup by fine-tuning on MS-COCO while retaining generative capabilities. We also measure the stereotypical bias in diffusion models, and find that Stable Diffusion 2.1 is, for the most part, less biased than Stable Diffusion 1.5. Overall, our results point in an exciting direction bringing discriminative and generative model evaluation closer. We will release code and benchmark setup soon.", "authors": [{"author": {"author_id": "916c873352ee355f8aa78e8fdeb6b58f", "name": "Benno Krojer", "links": [{"type": "openreview", "link": "~Benno_Krojer1"}, {"type": "semantic_scholar", "link": "1994697809"}, {"type": "semantic_scholar", "link": "2310235282"}]}, "affiliations": [{"institution_id": "2d64978822ccf8676fd9f98e10c823c2", "name": "McGill University", "category": "unknown"}, {"institution_id": "78a83265183550c66a78ff9b5f9b960f", "name": "Mila", "category": "unknown"}]}, {"author": {"author_id": "c6697678a137b834effe7bf845e62ef2", "name": "Elinor Poole-Dayan", "links": [{"type": "openreview", "link": "~Elinor_Poole-Dayan1"}, {"type": "semantic_scholar", "link": "2133330526"}]}, "affiliations": [{"institution_id": "2d64978822ccf8676fd9f98e10c823c2", "name": "McGill University", "category": "unknown"}]}, {"author": {"author_id": "91dd731c551c7590c43bfecaafa6087e", "name": "Vikram Voleti", "links": [{"type": "openreview", "link": "~Vikram_Voleti1"}, {"type": "semantic_scholar", "link": "2961618"}]}, "affiliations": [{"institution_id": "3fe172e8030a3a1bb7db6d2841086136", "name": "University of Montr\u00e9al", "category": "unknown"}, {"institution_id": "78a83265183550c66a78ff9b5f9b960f", "name": "Mila", "category": "unknown"}]}, {"author": {"author_id": "d4294b54e10232088f5feff243c4e293", "name": "Christopher Pal", "links": [{"type": "bio", "link": "pal-christopher"}, {"type": "email.mila", "link": "christopher.pal@mila.quebec"}, {"type": "mag", "link": "2168619732"}, {"type": "mag", "link": "2900737546"}, {"type": "mag", "link": "2910816495"}, {"type": "mag", "link": "2923024885"}, {"type": "openreview", "link": "~Christopher_Pal1"}, {"type": "semantic_scholar", "link": "1972076"}, {"type": "semantic_scholar", "link": "2061666783"}, {"type": "semantic_scholar", "link": "2061666816"}, {"type": "semantic_scholar", "link": "2061666830"}, {"type": "semantic_scholar", "link": "2132432404"}, {"type": "semantic_scholar", "link": "2242198325"}, {"type": "semantic_scholar", "link": "2243333924"}, {"type": "semantic_scholar", "link": "2249529376"}, {"type": "semantic_scholar", "link": "2252966270"}, {"type": "semantic_scholar", "link": "2265966393"}, {"type": "semantic_scholar", "link": "2275240361"}, {"type": "semantic_scholar", "link": "2282539195"}, {"type": "semantic_scholar", "link": "2283771332"}, {"type": "semantic_scholar", "link": "2288590587"}, {"type": "semantic_scholar", "link": "2294173613"}, {"type": "semantic_scholar", "link": "2294691864"}, {"type": "semantic_scholar", "link": "2295623112"}, {"type": "semantic_scholar", "link": "2310239092"}, {"type": "semantic_scholar", "link": "98109738"}, {"type": "wpid_en", "link": "362"}, {"type": "wpid_fr", "link": "329"}, {"type": "xplore", "link": "37086726955"}, {"type": "xplore", "link": "37282879700"}]}, "affiliations": [{"institution_id": "0a4595cdfa4e6d9d22cc74f6a6a2666f", "name": "Canada CIFAR AI Chair", "category": "unknown"}, {"institution_id": "522e63b4a8e0b8cd3098fffadf9a9b05", "name": "ServiceNow Research", "category": "unknown"}, {"institution_id": "78a83265183550c66a78ff9b5f9b960f", "name": "Mila", "category": "unknown"}, {"institution_id": "7e4719f0ce608d89628b3f55f38b7461", "name": "Polytechnique Montr\u00e9al", "category": "unknown"}]}, {"author": {"author_id": "d76795e0f68451af897d827a76a9dceb", "name": "Siva Reddy", "links": [{"type": "bio", "link": "siva-reddy"}, {"type": "email.mila", "link": "siva.reddy@mila.quebec"}, {"type": "mag", "link": "2169793708"}, {"type": "mag", "link": "2924809679"}, {"type": "openreview", "link": "~Siva_Reddy1"}, {"type": "semantic_scholar", "link": "145732771"}, {"type": "semantic_scholar", "link": "2256152032"}, {"type": "semantic_scholar", "link": "2258337753"}, {"type": "semantic_scholar", "link": "2260275234"}, {"type": "semantic_scholar", "link": "2283521815"}, {"type": "semantic_scholar", "link": "2283521818"}, {"type": "semantic_scholar", "link": "2284034011"}, {"type": "semantic_scholar", "link": "2286656700"}, {"type": "semantic_scholar", "link": "2289239506"}, {"type": "semantic_scholar", "link": "2289876704"}, {"type": "semantic_scholar", "link": "2295857229"}, {"type": "semantic_scholar", "link": "2301150002"}, {"type": "semantic_scholar", "link": "2312109206"}, {"type": "semantic_scholar", "link": "2313693935"}, {"type": "semantic_scholar", "link": "2323901201"}, {"type": "wpid_en", "link": "36949"}, {"type": "wpid_fr", "link": "37332"}]}, "affiliations": [{"institution_id": "2d64978822ccf8676fd9f98e10c823c2", "name": "McGill University", "category": "unknown"}, {"institution_id": "522e63b4a8e0b8cd3098fffadf9a9b05", "name": "ServiceNow Research", "category": "unknown"}, {"institution_id": "78a83265183550c66a78ff9b5f9b960f", "name": "Mila", "category": "unknown"}]}], "releases": [{"venue": {"venue_id": "2231305ebc59ffab234d656101ea6714", "name": "NeurIPS.cc/2023/Conference", "type": "conference", "date": {"text": "2023-09-21", "timestamp": 1695268800, "precision": 3}, "links": [{"type": "openreview-venue", "link": "NeurIPS.cc/2023/Conference"}], "publisher": null, "series": "", "volume": "NeurIPS 2023"}, "peer_reviewed": true, "status": "poster", "pages": null}], "topics": [{"name": "Computer Science"}, {"name": "automatic evaluation"}, {"name": "compositionality"}, {"name": "vision-and-language"}, {"name": "diffusion model"}], "links": [{"type": "html.official", "link": "https://proceedings.neurips.cc//paper_files/paper/2023/hash/1a675d804f50509b8e21d0d3ca709d03-Abstract-Conference.html"}, {"type": "pdf.official", "link": "https://proceedings.neurips.cc/paper_files/paper/2023/file/1a675d804f50509b8e21d0d3ca709d03-Paper-Conference.pdf"}, {"type": "doi.abstract", "link": "10.48550/arXiv.2305.16397", "url": "https://doi.org/10.48550/arXiv.2305.16397"}, {"type": "openreview.abstract", "link": "fmJv8Hj0yo", "url": "https://openreview.net/forum?id=fmJv8Hj0yo"}, {"type": "openreview.pdf", "link": "fmJv8Hj0yo", "url": "https://openreview.net/pdf?id=fmJv8Hj0yo"}, {"type": "arxiv.abstract", "link": "2305.16397", "url": "https://arxiv.org/abs/2305.16397"}, {"type": "arxiv.pdf", "link": "2305.16397", "url": "https://arxiv.org/pdf/2305.16397.pdf"}, {"type": "dblp.abstract", "link": "conf/nips/KrojerPVPR23", "url": "https://dblp.uni-trier.de/rec/conf/nips/KrojerPVPR23"}, {"type": "pdf", "link": "http://export.arxiv.org/pdf/2305.16397"}, {"type": "html", "link": "http://papers.nips.cc/paper_files/paper/2023/hash/1a675d804f50509b8e21d0d3ca709d03-Abstract-Conference.html"}, {"type": "semantic_scholar.abstract", "link": "14cb918ee6b9aab981c7b01c2c4db3ee4016abae", "url": "https://www.semanticscholar.org/paper/14cb918ee6b9aab981c7b01c2c4db3ee4016abae"}, {"type": "corpusid", "link": "258947037"}], "flags": [{"name": "validation", "value": 1}], "validated": true, "citation_count": 0, "excerpt": null}]
